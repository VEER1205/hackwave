<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Financial Analytics Dashboard</title>
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
      rel="stylesheet"
    />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <style>
      :root {
        --bg-primary: #0a0e17;
        --bg-secondary: #111827;
        --accent-primary: #10b981;
        --accent-secondary: #3b82f6;
        --accent-gradient: linear-gradient(
          135deg,
          #10b981 0%,
          #3b82f6 100%
        );
        --text-primary: #f9fafb;
        --text-secondary: #9ca3af;
        --border-color: #1f2937;
        --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
        --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        --background-dark: #0d1117;
        --card-background: #161b22;
        --border-color-alt: rgba(66, 133, 244, 0.2);
        --accent-green: #22c55e;
        --accent-teal: #14b8a6;
        --accent-red: #ef4444;
        --accent-blue: #3b82f6;
        --accent-yellow: #f59e0b;
        --accent-purple: #8b5cf6;
        --glow-color: rgba(20, 184, 166, 0.4);
      }

      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        margin: 0;
        background-color: var(--background-dark);
        color: var(--text-primary);
        font-family: "Inter", sans-serif;
        line-height: 1.6;
        background-image: radial-gradient(
            circle at 10% 20%,
            rgba(13, 17, 23, 0.8),
            rgba(13, 17, 23, 1) 50%
          ),
          radial-gradient(
            circle at 80% 70%,
            rgba(22, 27, 34, 0.7),
            rgba(13, 17, 23, 1) 60%
          );
      }

      /* --- Animations --- */
      @keyframes fadeInUp {
        from {
          opacity: 0;
          transform: translateY(20px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      .card,
      .header-container,
      .alert {
        animation: fadeInUp 0.5s ease-out forwards;
        opacity: 0;
      }

      /* Staggered animation delays */
      .grid-3 .card:nth-child(1) { animation-delay: 0.1s; }
      .grid-3 .card:nth-child(2) { animation-delay: 0.2s; }
      .grid-3 .card:nth-child(3) { animation-delay: 0.3s; }
      .alert.success { animation-delay: 0.4s; }
      .alert.warning { animation-delay: 0.5s; }
      .grid-main .card:nth-child(1) { animation-delay: 0.6s; }
      .grid-main .card:nth-child(2) { animation-delay: 0.7s; }
      .grid:not(.grid-3):not(.grid-main) .card:nth-child(1) { animation-delay: 0.8s; }
      .grid:not(.grid-3):not(.grid-main) .card:nth-child(2) { animation-delay: 0.9s; }

      /* --- Navbar --- */
      .navbar {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        background: rgba(10, 14, 23, 0.8);
        backdrop-filter: blur(12px);
        border-bottom: 1px solid var(--border-color);
        z-index: 1000;
        transition: var(--transition);
      }

      .navbar.scrolled {
        background: rgba(10, 14, 23, 0.95);
        box-shadow: var(--shadow-lg);
      }

      .nav-container {
        max-width: 1280px;
        margin: 0 auto;
        padding: 1rem 2rem;
        display: flex;
        align-items: center;
        justify-content: space-between;
      }

      .nav-logo {
        display: flex;
        align-items: center;
        gap: 0.75rem;
        font-size: 1.5rem;
        font-weight: 700;
        color: var(--text-primary);
        cursor: pointer;
      }

      .nav-logo i {
        color: var(--accent-primary);
        font-size: 1.75rem;
      }

      .nav-menu {
        display: flex;
        gap: 2rem;
        align-items: center;
      }

      .nav-link {
        color: var(--text-secondary);
        text-decoration: none;
        font-weight: 500;
        transition: var(--transition);
        position: relative;
        padding: 0.5rem 0;
      }

      .nav-link:hover,
      .nav-link.active {
        color: var(--accent-primary);
      }

      .nav-link::after {
        content: "";
        position: absolute;
        bottom: 0;
        left: 0;
        width: 0;
        height: 2px;
        background: var(--accent-gradient);
        transition: var(--transition);
      }

      .nav-link:hover::after,
      .nav-link.active::after {
        width: 100%;
      }

      .nav-actions {
        display: flex;
        align-items: center;
        gap: 1rem;
      }

      .mobile-toggle {
        display: none;
        font-size: 1.5rem;
        cursor: pointer;
        color: var(--text-primary);
      }

      .btn-primary,
      .btn-secondary {
        padding: 0.625rem 1.5rem;
        border-radius: 8px;
        font-weight: 600;
        cursor: pointer;
        transition: var(--transition);
        border: none;
        font-size: 0.95rem;
      }

      .btn-primary {
        background: var(--accent-gradient);
        color: white;
        box-shadow: 0 0 20px rgba(16, 185, 129, 0.3);
      }

      .btn-primary:hover {
        transform: translateY(-2px);
        box-shadow: 0 0 30px rgba(16, 185, 129, 0.5);
      }

      .btn-secondary {
        background: transparent;
        color: var(--text-primary);
        border: 1px solid var(--border-color);
      }

      .btn-secondary:hover {
        background: var(--bg-secondary);
        border-color: var(--accent-primary);
      }

      /* --- Main Dashboard --- */
      .dashboard {
        max-width: 1600px;
        margin: 0 auto;
        padding: 100px 32px 32px;
      }

      /* --- Header Section --- */
      .header-container {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 40px;
      }

      .header-title h1 {
        font-size: 32px;
        font-weight: 700;
        margin-bottom: 4px;
      }

      .header-title p {
        color: var(--text-secondary);
        font-size: 16px;
      }

      .header-profile {
        display: flex;
        align-items: center;
        gap: 16px;
      }

      .profile-info {
        text-align: right;
      }

      .profile-info span {
        display: block;
        font-weight: 600;
        color: var(--text-primary);
      }

      .profile-info small {
        color: var(--text-secondary);
        font-size: 12px;
      }

      .profile-photo {
        width: 50px;
        height: 50px;
        border-radius: 50%;
        overflow: hidden;
        border: 2px solid var(--border-color-alt);
      }

      .profile-photo img {
        width: 100%;
        height: 100%;
        object-fit: cover;
      }

      /* --- Grid Layout --- */
      .grid {
        display: grid;
        gap: 24px;
        margin-bottom: 24px;
      }

      .grid-3 {
        grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      }

      .grid-2 {
        grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
      }

      .grid-main {
        grid-template-columns: 2fr 1fr;
      }

      /* --- Card Styles --- */
      .card {
        background: var(--card-background);
        border: 1px solid var(--border-color-alt);
        border-radius: 12px;
        padding: 24px;
        transition: transform 0.3s ease, border-color 0.3s ease,
          box-shadow 0.3s ease;
      }

      .card:hover {
        transform: translateY(-5px);
        border-color: var(--accent-teal);
        box-shadow: 0 0 20px var(--glow-color);
      }

      .card-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 20px;
      }

      .card-title {
        font-size: 20px;
        font-weight: 600;
        color: var(--text-primary);
      }

      .card-subtitle {
        font-size: 13px;
        color: var(--text-secondary);
        font-weight: 400;
        margin-top: -16px;
        margin-bottom: 10px;
      }

      /* --- Metric Cards --- */
      .metric-card {
        display: flex;
        flex-direction: column;
        gap: 8px;
      }

      .metric-label {
        font-size: 14px;
        color: var(--text-secondary);
        order: 1;
      }

      .metric-value {
        font-size: 36px;
        font-weight: 700;
        order: 2;
        line-height: 1.2;
      }

      .metric-change {
        font-size: 14px;
        font-weight: 500;
        display: flex;
        align-items: center;
        gap: 6px;
        order: 3;
      }

      .metric-value.positive,
      .metric-change.positive {
        color: var(--accent-green);
      }

      .metric-value.negative,
      .metric-change.negative {
        color: var(--accent-red);
      }

      .metric-value.neutral {
        color: var(--accent-blue);
      }

      /* --- Chart Styles --- */
      .chart-container {
        position: relative;
        height: 280px;
      }

      .chart-small {
        height: 180px;
        margin-bottom: 20px;
      }

      .time-range-selector {
        background-color: var(--card-background);
        color: var(--text-primary);
        border: 1px solid var(--border-color-alt);
        border-radius: 8px;
        padding: 8px 12px;
        font-size: 14px;
        cursor: pointer;
        transition: background-color 0.3s ease, border-color 0.3s ease;
      }

      .time-range-selector:hover {
        background-color: #1f252d;
        border-color: var(--accent-teal);
      }

      .time-range-selector:focus {
        outline: none;
        border-color: var(--accent-teal);
      }

      /* --- Investment Breakdown --- */
      .investment-breakdown {
        display: flex;
        flex-direction: column;
        gap: 16px;
      }

      .investment-item {
        display: flex;
        align-items: center;
        gap: 12px;
        font-size: 14px;
      }

      .investment-color {
        width: 12px;
        height: 12px;
        border-radius: 3px;
      }

      .investment-percent {
        margin-left: auto;
        color: var(--text-secondary);
        font-weight: 500;
      }

      /* --- KPI Grid --- */
      .kpi-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
        gap: 16px;
      }

      .kpi-item {
        padding: 16px;
        background: var(--background-dark);
        border: 1px solid var(--border-color-alt);
        border-radius: 8px;
        text-align: center;
        transition: transform 0.2s ease;
      }

      .kpi-item:hover {
        transform: scale(1.05);
      }

      .kpi-label {
        font-size: 12px;
        color: var(--text-secondary);
        margin-bottom: 8px;
      }

      .kpi-value {
        font-size: 22px;
        font-weight: 600;
        color: var(--text-primary);
      }

      /* --- Transactions Table --- */
      .transactions-table {
        width: 100%;
        border-collapse: collapse;
      }

      .transactions-table th,
      .transactions-table td {
        text-align: left;
        padding: 16px 8px;
        border-bottom: 1px solid var(--border-color-alt);
      }

      .transactions-table tr:last-child td {
        border-bottom: none;
      }

      .transactions-table th {
        font-weight: 600;
        color: var(--text-secondary);
        font-size: 12px;
        text-transform: uppercase;
        letter-spacing: 0.5px;
      }

      .transactions-table td {
        font-size: 14px;
        vertical-align: middle;
      }

      .transactions-table td small {
        display: block;
        color: var(--text-secondary);
        font-size: 12px;
      }

      .transaction-type {
        padding: 4px 10px;
        border-radius: 12px;
        font-size: 12px;
        font-weight: 600;
        text-transform: uppercase;
      }

      .transaction-type.buy {
        background: rgba(34, 197, 94, 0.1);
        color: var(--accent-green);
      }

      .transaction-type.sell {
        background: rgba(239, 68, 68, 0.1);
        color: var(--accent-red);
      }

      /* --- Learning Progress --- */
      .progress-section {
        display: flex;
        flex-direction: column;
        gap: 20px;
        margin-top: 16px;
      }

      .course-progress {
        width: 100%;
      }

      .progress-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 8px;
        font-size: 14px;
      }

      .progress-header span:last-child {
        color: var(--text-secondary);
      }

      .progress-bar {
        height: 8px;
        background: var(--background-dark);
        border: 1px solid var(--border-color-alt);
        border-radius: 4px;
        overflow: hidden;
      }

      .progress-fill {
        height: 100%;
        background: linear-gradient(
          90deg,
          var(--accent-teal),
          var(--accent-green)
        );
        border-radius: 4px;
        transition: width 1s ease-in-out;
      }

      /* --- Alerts --- */
      .alert {
        padding: 16px;
        border-radius: 8px;
        margin-bottom: 24px;
        display: flex;
        align-items: center;
        gap: 12px;
        font-size: 14px;
        border: 1px solid;
      }

      .alert.success {
        background: rgba(34, 197, 94, 0.1);
        color: #adffcf;
        border-color: var(--accent-green);
      }

      .alert.success i {
        color: var(--accent-green);
      }

      .alert.warning {
        background: rgba(245, 158, 11, 0.1);
        color: #fde68a;
        border-color: var(--accent-yellow);
      }

      .alert.warning i {
        color: var(--accent-yellow);
      }

      /* --- Tooltip --- */
      .tooltip {
        position: relative;
        cursor: help;
      }

      .tooltip:hover::after {
        content: attr(data-tooltip);
        position: absolute;
        bottom: 125%;
        left: 50%;
        transform: translateX(-50%);
        background: #000;
        color: white;
        padding: 8px 12px;
        border-radius: 6px;
        font-size: 12px;
        white-space: nowrap;
        z-index: 1000;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
      }

      /* --- Responsive Design --- */
      @media (max-width: 1200px) {
        .grid-main {
          grid-template-columns: 1fr;
        }
      }

      @media (max-width: 768px) {
        .nav-menu {
          display: none;
          flex-direction: column;
          position: absolute;
          top: 100%;
          left: 0;
          right: 0;
          background: var(--bg-secondary);
          border-bottom: 1px solid var(--border-color);
          padding: 1rem 2rem;
          gap: 1rem;
        }

        .nav-menu.active {
          display: flex;
        }

        .mobile-toggle {
          display: block;
        }

        .dashboard {
          padding: 80px 16px 16px;
        }

        .header-container {
          flex-direction: column;
          align-items: flex-start;
          gap: 16px;
        }

        .header-profile {
          align-self: flex-start;
        }

        .grid-2,
        .grid-3 {
          grid-template-columns: 1fr;
        }
      }
    </style>
  </head>

  <body>
    <nav class="navbar">
      <div class="nav-container">
        <div class="nav-logo">
          <i class="fas fa-chart-line"></i>
          <span>TradeMaster Pro</span>
        </div>

        <div class="nav-menu" id="navMenu">
                <a href="#home" class="nav-link active">Home</a>
                <a href="#dashboard" class="nav-link">Dashboard</a>
                <a href="#analytics" class="nav-link">Trading</a>
                <a href="#ai-chatbot" class="nav-link">AI Assistant</a>
                <a href="#games" class="nav-link">Daily Quiz</a>
                <a href="#courses" class="nav-link">Courses</a>
        </div>

        <div class="nav-actions">
          <button class="btn-secondary">Sign In</button>
          <button class="btn-primary">Get Started</button>
          <div class="mobile-toggle" id="mobileToggle">
            <i class="fas fa-bars"></i>
          </div>
        </div>
      </div>
    </nav>

    <div class="dashboard">
      <div class="header-container">
        <div class="header-title">
          <h1>Welcome back, Falgun</h1>
          <p>Here’s your financial overview for today.</p>
        </div>
        <div class="header-profile">
          <div class="profile-info">
            <span>Falgun Patel</span>
            <small>falgunpatel2007@gmail.com</small>
          </div>
          <div class="profile-photo">
            <img
              src="https://api.dicebear.com/7.x/adventurer/svg?seed=Falgun"
              alt="Profile"
            />
          </div>
        </div>
      </div>

      <div class="grid grid-3">
        <div class="card metric-card">
          <div class="metric-label">Total Profit</div>
          <div
            class="metric-value positive tooltip"
            data-tooltip="Total profits from all investments"
          >
            ₹1,24,500
          </div>
          <div class="metric-change positive">
            <i class="fas fa-arrow-up"></i> 18.5% this month
          </div>
        </div>

        <div class="card metric-card">
          <div class="metric-label">Total Loss</div>
          <div
            class="metric-value negative tooltip"
            data-tooltip="Total losses from all investments"
          >
            ₹8,200
          </div>
          <div class="metric-change negative">
            <i class="fas fa-arrow-down"></i> 2.1% this month
          </div>
        </div>

        <div class="card metric-card">
          <div class="metric-label">Net Worth</div>
          <div
            class="metric-value neutral tooltip"
            data-tooltip="Current portfolio value"
          >
            ₹5,67,890
          </div>
          <div class="metric-change positive">
            <i class="fas fa-arrow-up"></i> 16.4% overall
          </div>
        </div>
      </div>

      <div class="alert success">
        <i class="fas fa-check-circle"></i>
        <div>
          <strong>Congratulations!</strong> Your SIP investment in HDFC Equity
          Fund generated ₹2,450 profit this month.
        </div>
      </div>
      <div class="alert warning">
        <i class="fas fa-exclamation-triangle"></i>
        <div>
          <strong>Market Alert:</strong> Your tech stocks are down 3.2% today.
          Consider reviewing your portfolio allocation.
        </div>
      </div>

      <div class="grid grid-main">
        <div class="card">
          <div class="card-header">
            <h3 class="card-title">Portfolio Growth Trend</h3>
            <select id="timeRange" class="time-range-selector">
              <option value="6m">Last 6 Months</option>
              <option value="1y">Last 1 Year</option>
              <option value="2y">Last 2 Years</option>
              <option value="all">All Time</option>
            </select>
          </div>
          <div class="chart-container">
            <canvas id="growthChart"></canvas>
          </div>
        </div>

        <div class="card">
          <div class="card-header">
            <h3 class="card-title">Investment Distribution</h3>
          </div>
          <p class="card-subtitle">
            As of Today: <span id="currentDate"></span>
          </p>

          <div class="chart-container chart-small">
            <canvas id="distributionChart"></canvas>
          </div>
          <div class="investment-breakdown">
            <div class="investment-item">
              <div class="investment-color" style="background: #3b82f6"></div>
              <span>Mutual Funds</span>
              <span class="investment-percent">45%</span>
            </div>
            <div class="investment-item">
              <div class="investment-color" style="background: #16a34a"></div>
              <span>Stocks</span>
              <span class="investment-percent">30%</span>
            </div>
            <div class="investment-item">
              <div class="investment-color" style="background: #f59e0b"></div>
              <span>IPO</span>
              <span class="investment-percent">15%</span>
            </div>
            <div class="investment-item">
              <div class="investment-color" style="background: #8b5cf6"></div>
              <span>Cryoto</span>
              <span class="investment-percent">10%</span>
            </div>
          </div>
        </div>
      </div>

      <div class="grid grid-2">
        <div class="card">
          <div class="card-header">
            <h3 class="card-title">Monthly Profit vs Loss</h3>
            <select id="plTimeRange" class="time-range-selector">
              <option value="6m" selected>Last 6 Months</option>
              <option value="12m">Last 12 Months</option>
            </select>
          </div>
          <div class="chart-container">
            <canvas id="profitLossChart"></canvas>
          </div>
        </div>
        <div class="card">
          <div class="card-header">
            <h3 class="card-title">Key Performance Indicators</h3>
          </div>
          <div class="kpi-grid">
            <div class="kpi-item tooltip" data-tooltip="Return on Investment">
              <div class="kpi-label">ROI</div>
              <div class="kpi-value">24.8%</div>
            </div>
            <div
              class="kpi-item tooltip"
              data-tooltip="Compound Annual Growth Rate"
            >
              <div class="kpi-label">CAGR</div>
              <div class="kpi-value">19.2%</div>
            </div>
            <div
              class="kpi-item tooltip"
              data-tooltip="Risk-adjusted returns"
            >
              <div class="kpi-label">Sharpe Ratio</div>
              <div class="kpi-value">2.14</div>
            </div>
            <div
              class="kpi-item tooltip"
              data-tooltip="Portfolio risk relative to market"
            >
              <div class="kpi-label">Beta</div>
              <div class="kpi-value">0.87</div>
            </div>
            <div
              class="kpi-item tooltip"
              data-tooltip="Risk-adjusted returns vs benchmark"
            >
              <div class="kpi-label">Alpha</div>
              <div class="kpi-value">3.6%</div>
            </div>
            <div
              class="kpi-item tooltip"
              data-tooltip="Maximum peak-to-trough decline"
            >
              <div class="kpi-label">Max Drawdown</div>
              <div class="kpi-value">-7.2%</div>
            </div>
          </div>
        </div>
      </div>

      <div class="grid grid-2">
        <div class="card">
          <div class="card-header">
            <h3 class="card-title">Recent Transactions</h3>
          </div>
          <table class="transactions-table">
            <thead>
              <tr>
                <th>Asset</th>
                <th>Type</th>
                <th>Amount</th>
                <th>Status</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>HDFC Bank <small>Nov 18</small></td>
                <td><span class="transaction-type buy">BUY</span></td>
                <td>₹25,000</td>
                <td class="metric-value positive" style="font-size: 14px">
                  +₹1,250
                </td>
              </tr>
              <tr>
                <td>Nifty 50 ETF <small>Nov 17</small></td>
                <td><span class="transaction-type buy">BUY</span></td>
                <td>₹15,000</td>
                <td class="metric-value positive" style="font-size: 14px">
                  +₹780
                </td>
              </tr>
              <tr>
                <td>TCS <small>Nov 15</small></td>
                <td><span class="transaction-type sell">SELL</span></td>
                <td>₹30,000</td>
                <td class="metric-value negative" style="font-size: 14px">
                  -₹850
                </td>
              </tr>
              <tr>
                <td>SBI Mutual Fund <small>Nov 12</small></td>
                <td><span class="transaction-type buy">BUY</span></td>
                <td>₹10,000</td>
                <td class="metric-value positive" style="font-size: 14px">
                  +₹450
                </td>
              </tr>
              <tr>
                <td>Reliance <small>Nov 10</small></td>
                <td><span class="transaction-type sell">SELL</span></td>
                <td>₹20,000</td>
                <td class="metric-value positive" style="font-size: 14px">
                  +₹1,200
                </td>
              </tr>
            </tbody>
          </table>
        </div>
        <div class="card">
          <div class="card-header">
            <h3 class="card-title">Learning Progress</h3>
          </div>
          <div class="progress-section">
            <div class="course-progress">
              <div class="progress-header">
                <span>Stock Market Fundamentals</span>
                <span style="color: var(--accent-green)">Completed</span>
              </div>
              <div class="progress-bar">
                <div class="progress-fill" style="width: 100%"></div>
              </div>
            </div>
            <div class="course-progress">
              <div class="progress-header">
                <span>Mutual Fund Investing</span> <span>85%</span>
              </div>
              <div class="progress-bar">
                <div class="progress-fill" style="width: 85%"></div>
              </div>
            </div>
            <div class="course-progress">
              <div class="progress-header">
                <span>Tax Planning Strategies</span> <span>60%</span>
              </div>
              <div class="progress-bar">
                <div class="progress-fill" style="width: 60%"></div>
              </div>
            </div>
            <div class="course-progress">
              <div class="progress-header">
                <span>Advanced Technical Analysis</span> <span>40%</span>
              </div>
              <div class="progress-bar">
                <div class="progress-fill" style="width: 40%"></div>
              </div>
            </div>
            <div class="course-progress">
              <div class="progress-header">
                <span>Retirement Planning</span> <span>15%</span>
              </div>
              <div class="progress-bar">
                <div class="progress-fill" style="width: 15%"></div>
              </div>
            </div>
          </div>
          <div class="kpi-grid" style="margin-top: 24px">
            <div class="kpi-item">
              <div class="kpi-label">Completed</div>
              <div class="kpi-value">12</div>
            </div>
            <div class="kpi-item">
              <div class="kpi-label">In Progress</div>
              <div class="kpi-value">6</div>
            </div>
            <div class="kpi-item">
              <div class="kpi-label">Remaining</div>
              <div class="kpi-value">8</div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script>
      // This section assumes you are using a templating engine like EJS.
      // It will display alerts based on server-side variables.
      <% if (errors && errors.length > 0) { %>
        Swal.fire({
          icon: 'error',
          title: 'Oops...',
          text: "<%= errors.join('\\n') %>"
        });
      <% } else if (success && success.length > 0) { %>
        Swal.fire({
          icon: 'success',
          title: 'Success!',
          text: "<%= success.join('\\n') %>"
        });
      <% } %>
    </script>
    <script>
      document.addEventListener("DOMContentLoaded", () => {
        // --- INITIALIZERS ---
        initNavbar();
        initNavLinks();
        initCharts();
        initUIComponents();
      });

      // --- NAVBAR LOGIC ---
      function initNavbar() {
        const navbar = document.querySelector(".navbar");
        const mobileToggle = document.getElementById("mobileToggle");
        const navMenu = document.getElementById("navMenu");

        window.addEventListener("scroll", () => {
          if (window.scrollY > 50) {
            navbar.classList.add("scrolled");
          } else {
            navbar.classList.remove("scrolled");
          }
        });

        if (mobileToggle) {
          mobileToggle.addEventListener("click", () => {
            navMenu.classList.toggle("active");
          });
        }
      }

      function initNavLinks() {
        const navLinks = document.querySelectorAll(".nav-link");
        const navMenu = document.getElementById("navMenu");

        navLinks.forEach((link) => {
          link.addEventListener("click", (e) => {
            navLinks.forEach((l) => l.classList.remove("active"));
            link.classList.add("active");

            // Close mobile menu on link click
            if (navMenu.classList.contains("active")) {
              navMenu.classList.remove("active");
            }
          });
        });
      }

      // --- UI COMPONENTS ---
      function initUIComponents() {
        // Set Current Date
        const dateElement = document.getElementById("currentDate");
        if (dateElement) {
          dateElement.textContent = new Date().toLocaleDateString("en-US", {
            year: "numeric",
            month: "long",
            day: "numeric",
          });
        }

        // Animate Metric Counters
        const metricValues = document.querySelectorAll(".metric-value");
        metricValues.forEach((el) => {
          const text = el.textContent.trim();
          // Animate only the main metric cards, not the table values
          if (text.startsWith("₹") && !el.hasAttribute("style")) {
            const value = parseFloat(text.replace(/[^0-9.-]+/g, ""));
            if (!isNaN(value)) {
              animateValue(el, 0, value, 1500);
            }
          }
        });
      }

      function animateValue(obj, start, end, duration) {
        let startTimestamp = null;
        const step = (timestamp) => {
          if (!startTimestamp) startTimestamp = timestamp;
          const progress = Math.min((timestamp - startTimestamp) / duration, 1);
          const current = Math.floor(progress * (end - start) + start);
          obj.innerHTML = `₹${current.toLocaleString("en-IN")}`;
          if (progress < 1) {
            window.requestAnimationFrame(step);
          }
        };
        window.requestAnimationFrame(step);
      }

      // --- CHART LOGIC ---
      function initCharts() {
        Chart.defaults.font.family = "'Inter', sans-serif";
        Chart.defaults.color = "#8b949e";

        // --- Data for Charts ---
        const growthChartData = {
          "6m": {
            labels: ["Jun", "Jul", "Aug", "Sep", "Oct", "Nov"],
            data: [510000, 525000, 515000, 540000, 560000, 567890],
          },
          "1y": {
            labels: ["Dec","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov"],
            data: [420000, 450000, 465000, 440000, 480000, 495000, 510000, 525000, 515000, 540000, 560000, 567890],
          },
          "2y": {
            labels: ["Q4 '23", "Q1 '24", "Q2 '24", "Q3 '24", "Q4 '24", "Q1 '25", "Q2 '25", "Q3 '25", "Q4 '25"],
            data: [380000, 420000, 445000, 465000, 480000, 495000, 520000, 535000, 567890],
          },
          all: {
            labels: ["2020", "2021", "2022", "2023", "2024", "2025"],
            data: [150000, 220000, 300000, 380000, 480000, 567890],
          },
        };

        const profitLossData = {
          "6m": {
            labels: ["Jun", "Jul", "Aug", "Sep", "Oct", "Nov"],
            profit: [14000, 16500, 13000, 19000, 17000, 21000],
            loss: [-3500, -2800, -4200, -1800, -2200, -3100],
          },
          "12m": {
            labels: ["Dec","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov"],
            profit: [9000, 12000, 8500, 15000, 11000, 18000, 14000, 16500, 13000, 19000, 17000, 21000],
            loss: [-4000, -3000, -5000, -2000, -4000, -1500, -3500, -2800, -4200, -1800, -2200, -3100],
          },
        };

        // 1. Growth Chart
        const growthCtx = document.getElementById("growthChart").getContext("2d");
        const gradient = growthCtx.createLinearGradient(0, 0, 0, 300);
        gradient.addColorStop(0, "rgba(20, 184, 166, 0.6)");
        gradient.addColorStop(1, "rgba(13, 17, 23, 0.1)");

        const growthChart = new Chart(growthCtx, {
          type: "line",
          data: {
            labels: growthChartData["6m"].labels,
            datasets: [{
              label: "Portfolio Value",
              data: growthChartData["6m"].data,
              borderColor: "#14b8a6",
              backgroundColor: gradient,
              fill: true,
              tension: 0.4,
              pointBackgroundColor: "#14b8a6",
              pointBorderColor: "#e6edf3",
              pointBorderWidth: 2,
              pointRadius: 4,
              pointHoverRadius: 7,
              pointHoverBackgroundColor: "#e6edf3",
              pointHoverBorderColor: "#14b8a6",
            }],
          },
          options: {
            responsive: true,
            maintainAspectRatio: false,
            interaction: {
              intersect: false,
              mode: "index"
            },
            plugins: {
              legend: {
                display: false
              },
              tooltip: {
                backgroundColor: "#0d1117",
                titleColor: "#e6edf3",
                bodyColor: "#e6edf3",
                borderColor: "rgba(66, 133, 244, 0.2)",
                borderWidth: 1,
                padding: 12,
                callbacks: {
                  label: (context) =>
                    `Value: ₹${context.parsed.y.toLocaleString()}`,
                },
              },
            },
            scales: {
              y: {
                beginAtZero: false,
                ticks: {
                  callback: (value) => `₹${value / 1000}K`,
                  color: "#8b949e",
                },
                grid: {
                  color: "rgba(139, 148, 158, 0.1)"
                },
              },
              x: {
                ticks: {
                  color: "#8b949e"
                },
                grid: {
                  display: false
                },
              },
            },
          },
        });

        // 2. Distribution Pie Chart
        const distributionCtx = document.getElementById("distributionChart").getContext("2d");
        new Chart(distributionCtx, {
          type: "doughnut",
          data: {
            labels: ["Mutual Funds", "Stocks", "Fixed Deposits", "Gold"],
            datasets: [{
              data: [45, 30, 15, 10],
              backgroundColor: ["#3b82f6", "#14b8a6", "#f59e0b", "#8b5cf6"],
              borderWidth: 4,
              borderColor: "#161b22",
              hoverOffset: 12,
              hoverBorderColor: "#14b8a6",
            }],
          },
          options: {
            responsive: true,
            maintainAspectRatio: false,
            cutout: "75%",
            plugins: {
              legend: {
                display: false
              },
              tooltip: {
                backgroundColor: "#0d1117",
                callbacks: {
                  label: (context) => ` ${context.label}: ${context.parsed}%`,
                },
              },
            },
          },
        });

        // 3. Profit vs Loss Chart
        const profitLossCtx = document.getElementById("profitLossChart").getContext("2d");
        const profitLossChart = new Chart(profitLossCtx, {
          type: "bar",
          data: {
            labels: profitLossData["6m"].labels,
            datasets: [{
                label: "Profit",
                data: profitLossData["6m"].profit,
                backgroundColor: "rgba(34, 197, 94, 0.8)",
                borderRadius: 4,
                hoverBackgroundColor: "#22c55e",
              },
              {
                label: "Loss",
                data: profitLossData["6m"].loss,
                backgroundColor: "rgba(239, 68, 68, 0.8)",
                borderRadius: 4,
                hoverBackgroundColor: "#ef4444",
              },
            ],
          },
          options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
              legend: {
                labels: {
                  boxWidth: 12,
                  padding: 20,
                  color: "#e6edf3",
                },
              },
              tooltip: {
                backgroundColor: "#0d1117",
                callbacks: {
                  label: (context) =>
                    `${context.dataset.label}: ₹${Math.abs(
                      context.parsed.y
                    ).toLocaleString()}`,
                },
              },
            },
            scales: {
              y: {
                ticks: {
                  callback: (value) => `₹${value / 1000}K`,
                  color: "#8b949e",
                },
                grid: {
                  color: "rgba(139, 148, 158, 0.1)"
                },
              },
              x: {
                ticks: {
                  color: "#8b949e"
                },
                grid: {
                  display: false
                },
              },
            },
          },
        });

        // --- Event Listeners for Dropdowns ---
        document.getElementById("timeRange").addEventListener("change", function () {
          const selectedRange = this.value;
          growthChart.data.labels = growthChartData[selectedRange].labels;
          growthChart.data.datasets[0].data = growthChartData[selectedRange].data;
          growthChart.update();
        });

        document.getElementById("plTimeRange").addEventListener("change", function () {
          const selectedRange = this.value;
          const newData = profitLossData[selectedRange];
          profitLossChart.data.labels = newData.labels;
          profitLossChart.data.datasets[0].data = newData.profit;
          profitLossChart.data.datasets[1].data = newData.loss;
          profitLossChart.update();
        });
      }
    </script>
  </body>
</html>